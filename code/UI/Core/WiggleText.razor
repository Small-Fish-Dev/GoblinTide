@using Sandbox.UI;

@namespace GameJam.UI.Core
@inherits Panel

<style>
	WiggleText {	
		.image {
			width: @( ImageWidth )px;
			height: @( ImageHeight )px;
			
			background-size: contain;
			background-repeat: no-repeat;
			
			image-rendering: pixelated;
		}
	}
</style>

<root>
	@foreach ( var c in Value )
	{
		switch ( c )
		{
			case ',':
				<AnimatedImage style="@InvertString" class="image" path=@( "textures/tests/generic/comma" )></AnimatedImage>
				break;
			case '.':
				<AnimatedImage style="@InvertString" class="image" path=@( "textures/tests/generic/dot" )></AnimatedImage>
				break;
			default:
				{
					if ( char.IsDigit( c ) )
					{
						<AnimatedImage style="@InvertString" class="image" path=@( $"textures/tests/number/{c}" )></AnimatedImage>
					}
					else
					{
						<AnimatedImage style="@InvertString" class="image" path=@( $"textures/tests/upper/{c}" )></AnimatedImage>
					}
					break;
				}
		}
	}
</root>

@code {
	public string Value { get; set; } = "0";
	public float Scale { get; set; } = 0.8f;
	public bool Invert { get; set; } = true;

	private string InvertString
	{
		get
		{
			if ( !Invert ) return "filter: invert(100)";
			return "";
		}
	}

	public float ImageHeight => 116 * Scale;
	public float ImageWidth => ((float)64 / 116) * ImageHeight;

	protected override int BuildHash()
	{
		return HashCode.Combine( Value, Value.Length );
	}

}
